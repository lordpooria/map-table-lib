import{__spreadArrays as e,__assign as t,__rest as n}from"tslib";import r,{createContext as l,useContext as o,useState as i,useCallback as a,useRef as c,useMemo as s,useEffect as u,memo as d,Fragment as m,forwardRef as v}from"react";import{action as f,computed as p,createStore as h,useLocalStore as g,useStore as y,StoreProvider as E,createTypedHooks as b}from"easy-peasy";import{StylesProvider as w,ThemeProvider as C}from"@material-ui/styles";import{useThemeObject as x,StyleProvider as S,useLanguageState as k,SmallIconButton as R,useTranslation as I,WithFontTypography as L,ButtonTooltip as N}from"@hesaba/theme-language";import{makeStyles as A,createStyles as T,Typography as P,IconButton as W,Menu as V,MenuItem as H,FormControlLabel as z,Switch as F,TextField as O,Checkbox as B,withStyles as D,Toolbar as _,Select as M,InputBase as K}from"@material-ui/core";import q from"clsx";import{Autocomplete as j}from"@material-ui/lab";import{DatePicker as Z,MuiPickersUtilsProvider as X}from"@material-ui/pickers";import G from"@date-io/dayjs";import U from"dayjs";import Y from"jalaliday";import{VariableSizeList as J}from"react-window";import Q from"react-virtualized-auto-sizer";var $="preperation.filter.operations.",ee=function(e){return{commonOperations:[{key:"equals",name:e($+"equals"),type:"common",valSize:1},{key:"notEquals",name:e($+"notEquals"),type:"common",valSize:1},{key:"isNull",name:e($+"isNull"),type:"common"},{key:"isNotNull",name:e($+"isNotNull"),type:"common"},{key:"isEmpty",name:e($+"isEmpty"),type:"common"},{key:"isNotEmpty",name:e($+"isNotEmpty"),type:"common"},{key:"contains",name:e($+"contains"),type:"common",valSize:1},{key:"notContaines",name:e($+"notContaines"),type:"common",valSize:1}],stringOptions:[{key:"regex",name:e($+"regex"),type:"string",valSize:1},{key:"startWith",name:e($+"startWith"),type:"string",valSize:1},{key:"endWith",name:e($+"endWith"),type:"string",valSize:1}],numericOptions:[{key:"between",name:e($+"between"),type:"number",valSize:2}],dateOptions:[{key:"dateFrom",name:e($+"dateFrom"),type:"date",valSize:1},{key:"dateTo",name:e($+"dateTo"),type:"date",valSize:1},{key:"between",name:e($+"between"),type:"date",valSize:2}],mapOptions:[{key:"surrounded",name:e($+"surrounded"),type:"geographic",valSize:1}]}},te=h({VTVersion:"1.0.0",settings:{direction:"rtl",lang:"fa"},visibleRows:[],enhancedColumns:[],showFilter:!1,filters:[],toggleSingleRow:f((function(e,t){var n=t.index;e.visibleRows[n].selected=!e.visibleRows[n].selected})),toggleAllRows:f((function(e,n){var r=n.isSelected;e.visibleRows=e.visibleRows.map((function(e){return t(t({},e),{selected:!r})}))})),toggleShowFilter:f((function(e,t){if(0===e.filters.length){var n=e.enhancedColumns[0];e.filters.push({id:(new Date).getTime().toString(),column:[{key:n.key,label:n.label,type:n.type}],operation:void 0,value:[void 0]})}e.showFilter=t})),setTableData:f((function(e,t){var n=t.enhancedColumns,r=t.visibleRows;e.visibleRows=r,e.enhancedColumns=n})),fakeAppendTableData:f((function(t,n){var r=n.rows,l=n.index;t.visibleRows=e(t.visibleRows.slice(0,l+1),r,t.visibleRows.slice(l+1))})),toggleVisibleColumns:f((function(e,t){var n=t.index;e.enhancedColumns[n].visible=!e.enhancedColumns[n].visible})),setStickyColumn:f((function(e,t){var n=t.index;e.enhancedColumns[n].sticky=!e.enhancedColumns[n].sticky})),numRowsSelected:p((function(e){return e.visibleRows.filter((function(e){return e.selected})).length})),selectedRows:p((function(t){return t.visibleRows.reduce((function(t,n,r){return n.selected?e(t,[r]):t}),[])})),visibleColumns:p((function(e){return e.enhancedColumns.filter((function(e){return e.visible&&!e.sticky}))})),stickyColumns:p((function(e){return e.enhancedColumns.filter((function(e){return e.visible&&e.sticky}))})),sortTable:f((function(e,t){var n=t.index,r=t.sortType,l=t.columnKey;if(e.visibleColumns[n]){var o=e.enhancedColumns.findIndex((function(e){return e.key===l}));-1!==o&&(e.enhancedColumns.map((function(e){return e.sorted=void 0})),e.enhancedColumns[o].sorted=r,e.visibleRows.length>0&&(e.visibleRows="DESC"===r?e.visibleRows.sort((function(e,t){return e[l]<t[l]?1:-1})):e.visibleRows.sort((function(e,t){return e[l]<t[l]?-1:1}))))}else console.warn("column not found something wrong!")})),filterSetColumn:f((function(e,t){var n,r=t.filterIndex,l=t.column,o=t.columnIndex,i=e.filters[r];(null===(n=i.operation)||void 0===n?void 0:n.type)!==l.type&&(i.operation=void 0),i.column[o]=l})),filterSetOperation:f((function(t,n){var r,l=n.filterIndex,o=n.operation;t.filters[l].operation=o;var i=null===(r=t.filters[l].column[0])||void 0===r?void 0:r.type;t.filters[l].value=function(t,n){return n.valSize?e(new Array(n.valSize).fill("date"===t?(new Date).toISOString():"number"===t?0:"geographic"===t?void 0:"")):[]}(i,o)})),filterSetValue:f((function(e,t){var n=t.filterIndex,r=t.value,l=t.valueIndex;e.filters[n].value[l]=r})),filterAdd:f((function(e,t){var n=t.columnKey;e.showFilter=!0;var r=e.enhancedColumns.filter((function(e){return e.key===n}));r&&0!==r.length&&e.filters.push({id:(new Date).getTime().toString(),column:[{key:r[0].key,label:r[0].label,type:r[0].type}],operation:void 0,value:[void 0]})})),filterDelete:f((function(e,t){var n,r=t.index;null===(n=e.filters)||void 0===n||n.splice(r,1)}))}),ne=function(e){var t=e.children,n=x();return r.createElement(w,{injectFirst:!0},r.createElement(C,{theme:n},t))},re={currentWidths:{},totalWidth:0,setSizes:f((function(e,t){var n=t.totalWidth,r=t.currentWidths;e.currentWidths=r,e.totalWidth=n})),setCurrentWidth:f((function(e,t){var n=t.currentWidths;e.currentWidths=n})),setTotalWidth:f((function(e,t){var n=t.totalWidth;e.totalWidth=n}))},le=l({}),oe=l({});function ie(e){var t=e.children,n=g((function(){return re})),l=n[0],o=n[1];return r.createElement(oe.Provider,{value:{state:l}},r.createElement(le.Provider,{value:{actions:o}},t))}function ae(){var e=o(oe).state;if(!e)throw Error("use state inside provider");return e}function ce(){var e=o(le).actions;if(!e)throw Error("use state inside provider");return e}var se=l({}),ue=l({});function de(e){var t=e.children,n=i({activeRow:-1}),l=n[0],o=n[1],c=a((function(e){o({activeRow:e})}),[]);return r.createElement(ue.Provider,{value:l},r.createElement(se.Provider,{value:c},t))}function me(){var e=o(ue);if(!e)throw Error("use state inside provider");return e}function ve(){var e=o(se);if(!e)throw Error("use state inside provider");return e}var fe=function(e){var t,n=e.children,l=y();return(null===(t=null==l?void 0:l.getState())||void 0===t?void 0:t.VTVersion)?r.createElement(r.Fragment,null,n):r.createElement(ie,null,r.createElement(de,null,r.createElement(E,{store:te},n)))},pe=function(e){var t=e.children,n=e.direction,l=e.language,o=e.theme;return r.createElement(S,{language:l,direction:n,theme:o},r.createElement(ne,null,t))},he="MainVirtualListId",ge=50,ye=function(){var e=c(),t=c(),n=c(),r=k().direction,l=c(r),o=c({}),i=c(0),a=c(),d=ce().setSizes,m=c(),v=s((function(){var r=function(r){var l;!function(){var e,r;t.current=null===(e=m.current)||void 0===e?void 0:e.querySelectorAll(".HESABA_TABLE_HEADER_CLASS"),n.current=null===(r=m.current)||void 0===r?void 0:r.querySelectorAll(".HESABA_TABLE_ROW_CLASS")}();var o=r.target;if(o.classList.contains("HESABA_DRAG_HANDLER")){var i=o.previousElementSibling;i&&(a.current=i.getAttribute("data-field"),window.addEventListener("mousemove",c),window.addEventListener("mouseup",s),e.current=null===(l=m.current)||void 0===l?void 0:l.querySelectorAll('[data-field="'+a.current+'"]'))}},c=function(r){if(e.current&&0!==e.current.length&&t.current&&0!==t.current.length&&m&&n.current){var o=24;if("rtl"===l.current){var a=e.current[0].getBoundingClientRect().right;o=Math.max(-r.clientX+a,24)}else{var c=e.current[0].getBoundingClientRect().left;o=Math.max(r.clientX-c,24)}var s=0;t.current.forEach((function(e){return s+=e.getBoundingClientRect().width+24})),i.current=s,e.current.forEach((function(e,t){0===t?(e.style.width=o+"px",e.style.minWidth=o+"px",e.style.maxWidth=o+"px"):(e.style.width=o+24+"px",e.style.minWidth=o+24+"px",e.style.maxWidth=o+24+"px")}))}},s=function t(n){window.removeEventListener("mousemove",c),window.removeEventListener("mouseup",t),a.current&&e.current&&0!==e.current.length&&("rtl"===l.current?o.current[a.current]=-n.clientX+e.current[0].getBoundingClientRect().right:o.current[a.current]=n.clientX-e.current[0].getBoundingClientRect().left,d({totalWidth:i.current,currentWidths:o.current}))};return[function(e){e&&(m.current=e,m.current.addEventListener("mousedown",r))},function(e){e.removeEventListener("mousedown",r)}]}),[]),f=v[0],p=v[1];return u((function(){return function(){m.current&&p(m.current)}}),[p]),u((function(){l.current=r}),[r]),{setTableRef:f,tableRef:m}},Ee=b(),be=Ee.useStoreActions,we=Ee.useStoreDispatch,Ce=Ee.useStoreState,xe=Ee.useStore;function Se(e){return e.map((function(e){var n,r;return t(t({},e),((n={})["data-field"]="HESABA_DATA_FIELD-"+e.key,n.visible=!0,n.sticky=!1,n.sorted=void 0,n.type=null!==(r=null==e?void 0:e.type)&&void 0!==r?r:"string",n))}))}function ke(e){return e.map((function(e,n){return t({id:n,selected:!1},e)}))}function Re(e,t){return{enhancedColumns:Se(e),visibleRows:ke(t)}}var Ie=A((function(e){return T({root:{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,fontSize:24,transition:e.transitions.create("fill",{duration:e.transitions.duration.shorter})}})})),Le=d((function(e){var l=e.className,o=e.id,i=e.children,a=n(e,["className","id","children"]),c=Ie();return r.createElement("svg",t({className:q(c.root,l),id:o,width:"24",height:"24",viewBox:"0 0 24 24"},a),i)})),Ne=function(e){var t=e.className;return r.createElement(Le,{className:t,id:"mdi-dots-vertical"},r.createElement("path",{d:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"}))},Ae=A((function(e){return T({toolbarContainer:{borderBottom:"solid "+e.palette.grey[300]+" 1px",display:"flex",alignItems:"center"},tools:{display:"flex",alignItems:"center",flex:1},title:{padding:"0 "+e.spacing(1)},icon:{fill:e.palette.secondary.main}})})),Te=function(e){var l=e.title,o=e.height,i=e.classes,a=n(e,["title","height","classes"]),c=Ae();return r.createElement("div",{style:{height:o||70},className:q(c.toolbarContainer,null==i?void 0:i.root)},r.createElement("div",{className:q(c.tools)},r.createElement(Pe,{classes:i}),a.operationOnRows&&r.createElement(We,t({},a))),r.createElement(P,{align:"center",className:c.title},null!=l?l:""))};function Pe(e){var t,n=e.classes,l=i(null),o=l[0],a=l[1],c=Boolean(o),s=Ce((function(e){return e.enhancedColumns})),u=Ae(),d=function(){a(null)},m=be((function(e){return e.toggleVisibleColumns})),v=be((function(e){return e.toggleShowFilter}));return r.createElement(r.Fragment,null,r.createElement(W,{onClick:function(e){a(e.currentTarget)},className:null==n?void 0:n.iconButton},r.createElement(Ne,{className:q((t={},t[u.icon]=!(null==n?void 0:n.icon),t),null==n?void 0:n.icon)})),r.createElement(V,{disableScrollLock:!0,id:"long-menu",anchorEl:o,keepMounted:!0,open:c,onClose:d,className:null==n?void 0:n.menu},r.createElement(H,{className:null==n?void 0:n.menuItem,onClick:function(){v(!0),d()}},"filter"),null==s?void 0:s.map((function(e,t){return r.createElement(H,{key:e.key,className:null==n?void 0:n.menuItem},r.createElement(z,{control:r.createElement(F,{checked:e.visible,onChange:function(){return m({index:t})},name:e.label}),label:e.label}))}))))}function We(e){var t=e.operationOnRows,n=Ce((function(e){return e.numRowsSelected}));return r.createElement(r.Fragment,null,t&&n>0&&t.map((function(e,t){return r.createElement(e,{key:t})})))}function Ve(e){var t=e.filterIndex,n=e.valIndex,l=e.onSetFilter,o=e.value,i=e.label,a=e.classes;return r.createElement(O,{classes:{root:q(null==a?void 0:a.root,null==a?void 0:a.input)},key:"number-"+n,value:o,onChange:function(e){e.target.value&&l(t,n,e.target.value)},type:"number",label:i,variant:"standard"})}function He(e){var t=e.filterIndex,n=e.valIndex,l=e.onSetFilter,o=e.value,i=e.classes,a=e.label;return r.createElement(O,{classes:{root:q(null==i?void 0:i.root,null==i?void 0:i.input)},key:"string-"+n,value:o,onChange:function(e){return function(n){n.target.value&&l(t,e,n.target.value)}}(n),label:a,variant:"standard"})}U.extend(Y);var ze=function(e){var t=e.children;return r.createElement(X,{utils:G,locale:"fa"},t)},Fe=function(e){var t=e.filterIndex,n=e.valIndex,l=e.onSetFilter,o=e.value,i=e.classes,a=e.label;return r.createElement(ze,null,r.createElement(Z,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-inline",value:o,className:null==i?void 0:i.root,key:"date-"+n,onChange:function(e){e&&l(t,n,e.toISOString())},label:a,inputVariant:"standard",InputProps:{classes:{root:null==i?void 0:i.input}},animateYearScrolling:!0}))},Oe=A((function(){return T({input:{borderColor:"transparent"}})})),Be=d((function(e){var n=e.value,l=e.filterIndex,o=e.columns,a=e.columnIndex,c=e.classes,s=Oe(),u=i(""),d=u[0],m=u[1],v=be((function(e){return e.filterSetColumn}));return r.createElement(j,{value:n,onChange:function(e,t){t&&"string"!=typeof t&&v({column:t,columnIndex:a,filterIndex:l})},freeSolo:!0,inputValue:d,onInputChange:function(e,t){m(t)},options:o,className:q(s.input,null==c?void 0:c.root),getOptionLabel:function(e){return e?e.label:""},getOptionSelected:function(e,t){return!(null==e?void 0:e.label)||e.label===t.label},renderInput:function(e){return r.createElement(O,t({},e,{classes:{root:null==c?void 0:c.input},label:"column",variant:"standard"}))}})})),De=d((function(n){var l=n.operation,o=n.filterIndex,a=n.columnType,s=n.classes,d=function(e){return e},m=Oe(),v=be((function(e){return e.filterSetOperation})),f=i(ee(d).commonOperations),p=f[0],h=f[1],g=i(""),y=g[0],E=g[1],b=c("");return u((function(){if(a&&b.current!==a&&a)switch(b.current=a,a){case"geographic":h(e(ee(d).mapOptions));break;case"number":h(e(ee(d).commonOperations,ee(d).numericOptions));break;case"string":h(e(ee(d).commonOperations,ee(d).stringOptions));break;case"date":h(e(ee(d).commonOperations,ee(d).dateOptions));break;default:h(ee(d).commonOperations)}}),[a,d]),r.createElement(j,{autoComplete:!0,value:l,onChange:function(e,t){t&&"string"!=typeof t&&v({operation:t,filterIndex:o})},freeSolo:!0,inputValue:y,onInputChange:function(e,t){E(t)},options:p,className:q(m.input,null==s?void 0:s.root),getOptionLabel:function(e){var t;return null!==(t=null==e?void 0:e.name)&&void 0!==t?t:""},getOptionSelected:function(e,t){return!!(null==e?void 0:e.name)||e.name===t.name},renderInput:function(e){return r.createElement("div",{style:{display:"flex",alignItems:"center"}},r.createElement(O,t({},e,{classes:{root:null==s?void 0:s.input},label:"op",InputProps:t({},e.InputProps),variant:"standard"})))}})})),_e=d((function(e){var t=e.filterIndex,n=e.val,l=e.valIndex,o=e.columnType,i=e.label,a=e.classes,c=be((function(e){return e.filterSetValue})),s=void 0;return s="date"===o?Fe:"number"===o?Ve:He,r.createElement(s,{filterIndex:t,valIndex:l,onSetFilter:function(e,t,n){c({filterIndex:e,valueIndex:t,value:n})},value:n,label:i,classes:a})})),Me=function(e){var t=e.className;return r.createElement(Le,{className:t,id:"mdi-trash-can-outline"},r.createElement("path",{d:"M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z"})," ")},Ke=A((function(e){return T({deleteButton:{},inputs:{width:150},autoComplete:{margin:e.spacing(1)}})})),qe=function(e){var t,n,l=e.filter,o=e.columns,i=e.index,a=Ke(),c=be((function(e){return e.filterDelete}));return(null===(t=null==l?void 0:l.column)||void 0===t?void 0:t.length)?r.createElement(r.Fragment,null,r.createElement(W,{size:"small",className:a.deleteButton,onClick:function(){return c({index:i})}},r.createElement(Me,null)),null==l?void 0:l.column.map((function(e,t){var n;return r.createElement(Be,{key:(null===(n=null==l?void 0:l.column[0])||void 0===n?void 0:n.type)+"-"+t,filterIndex:i,value:e,columnIndex:t,columns:o,classes:{root:a.autoComplete,input:a.inputs}})})),r.createElement(De,{columnType:null===(n=null==l?void 0:l.column[0])||void 0===n?void 0:n.type,filterIndex:i,operation:l.operation,classes:{root:a.autoComplete,input:a.inputs}}),l.value.map((function(e,t){var n,o;return r.createElement(_e,{key:(null===(n=null==l?void 0:l.column[0])||void 0===n?void 0:n.type)+"-"+t,filterIndex:i,valIndex:t,val:e,columnType:null===(o=null==l?void 0:l.column[0])||void 0===o?void 0:o.type,label:"value",classes:{root:a.autoComplete,input:a.inputs}})}))):null},je=function(e){var t=e.className;return r.createElement(Le,{className:t,id:"mdi-close"},r.createElement("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})," ")},Ze=A((function(e){return T({rootFilter:{position:"absolute",backgroundColor:"#FFF",padding:e.spacing(1),top:20,left:20,boxShadow:e.shadows[2]},filterWrapper:{display:"flex",alignItems:"center"}})})),Xe=function(e){var t=Ze(),n=Ce((function(e){return e.showFilter})),l=be((function(e){return e.toggleShowFilter})),o=Ce((function(e){return e.filters}));return n?r.createElement("div",{className:t.rootFilter},r.createElement(W,{size:"small",onClick:function(){l(!1)},style:{float:"right"}},r.createElement(je,null)),o.map((function(e,n){return r.createElement("div",{key:e.id,className:t.filterWrapper},r.createElement(qe,{filter:e,index:n,columns:[]}))})),r.createElement("div",{style:{width:"100%"}})):null},Ge=function(e,t){var n=ae().totalWidth;return a((function(){if(n)return n>t?n:t;var r=e.reduce((function(e,t){return e+((null==t?void 0:t.minWidth)||124)}),48);return r>t?r:t}),[e,t,n])};function Ue(e,t){return t||e}var Ye=A((function(e){return T({vtContainerRoot:{width:"100%"},commonVTContainer:{border:"solid 1px "+e.palette.grey[300]}})})),Je=function(e){var t=e.children,n=e.classes,l=e.width,o=Ye(),i=k().direction;return r.createElement("div",{className:q(Ue(o.commonVTContainer,null==n?void 0:n.root),o.vtContainerRoot),style:{width:l,direction:i}},t)},Qe=function(e){return r.createElement("div",{style:{position:"absolute",pointerEvents:"none",right:0,left:0,top:0,bottom:0,overflow:"hidden"}})};function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var et=A((function(){return T({rowCell:{},simpleCell:{fontFamily:"inherit"}})})),tt=function(e){var t=e.value,n=e.className,l=et();return r.createElement(P,{align:"center",className:q(l.simpleCell,n)},t)},nt=function(e){var l,o=e.label,i=e.minWidth,a=void 0===i?100:i,c=e.colKey,s=e.CellComponent,u=void 0===s?tt:s;e.HeaderComponent,e.visible,e.sorted;var d=e.row,m=e.rowIndex;e.colIndex,e.columnsLength;var v=e.classes;e.sticky,e.custom,e.isScrolling;var f=n(e,["label","minWidth","colKey","CellComponent","HeaderComponent","visible","sorted","row","rowIndex","colIndex","columnsLength","classes","sticky","custom","isScrolling"]),p=et(),h=ae().currentWidths,g=h[f["data-field"]]?h[f["data-field"]]+24:a+24,y="object"===$e(d[c])?null===(l=d[c])||void 0===l?void 0:l.value:d[c];return r.createElement("div",t({},f,{key:c,style:{minWidth:g||a,width:g||a,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal"},className:q(p.rowCell,null==v?void 0:v.root)}),r.createElement(u,{label:o,index:m,rowKey:m,row:d,value:y,className:null==v?void 0:v.simpleCell}))},rt=A((function(){return T({tableCell:{overflow:"hidden",display:"flex",height:"100%",alignItems:"center",justifyContent:"center","& >button":{opacity:0},"&:hover >button":{opacity:1}},checkbox:{width:48,height:48}})})),lt=A((function(e){return T({evenRow:{backgroundColor:"#f8f8f0"},oddRow:{},tableRow:{display:"flex",alignItems:"center",overflow:"hidden",marginTop:ge},tableRowCommon:{borderBottom:"solid "+e.palette.grey[300]+" 1px","&:hover":{backgroundColor:"rgba(0,0,0,0.1)"}},rowCell:{},selected:{backgroundColor:"rgba(100,100,255,0.1)"},activatedRow:{backgroundColor:"rgba(255,100,255,0.1)"}})}));function ot(e){return r.createElement(r.Fragment,null,r.createElement(it,t({},e)))}var it=function(e){var l,o,i,c,s=e.style,u=e.rowIndex,d=e.selectable,v=e.classes,f=e.width,p=e.CheckboxProps,h=e.onRowClick,g=e.extraStyles,y=e.selectedRowStyle,E=n(e,["style","rowIndex","selectable","classes","width","CheckboxProps","onRowClick","extraStyles","selectedRowStyle"]),b=lt(),w=rt(),C=Ce((function(e){return e.visibleColumns})),x=Ce((function(e){return e.visibleRows})),S=be((function(e){return e.toggleSingleRow})),k=Ge(C,f),R=me().activeRow,I=a((function(){h&&h(u)}),[h]);return r.createElement("div",{style:t(t(t(t({},s),g),R===u&&y),{width:k()}),className:q("HESABA_TABLE_ROW_CLASS",b.tableRow,Ue(b.tableRowCommon,null==v?void 0:v.root),(l={},l[b.selected]=x[u].selected,l),(o={},o[b.activatedRow]=R===u,o),(i={},i[(null==v?void 0:v.evenRow)||"tempEvenRow"]=(null==v?void 0:v.evenRow)&&u%2==0,i),(c={},c[(null==v?void 0:v.oddRow)||"tempOddRow"]=(null==v?void 0:v.oddRow)&&u%2!=0,c)),onClick:I},d&&r.createElement(B,t({checked:x[u].selected,onChange:function(){S({index:u})},color:"primary",classes:{root:w.checkbox},onClick:function(e){return e.stopPropagation()}},p)),C.map((function(e,n){return r.createElement(m,{key:e.key},r.createElement(nt,t({},e,E,{colIndex:n,row:x[u],rowIndex:u,columnsLength:C.length,colKey:e.key})))})))},at=function(e){var t=e.className;return r.createElement(Le,{className:t,id:"mdi-arrow-down"},r.createElement("path",{d:"M11,4H13V16L18.5,10.5L19.92,11.92L12,19.84L4.08,11.92L5.5,10.5L11,16V4Z"}))},ct=function(e){var t=e.className;return r.createElement(Le,{className:t,id:"mdi-arrow-up"},r.createElement("path",{d:"M13,20H11V8L5.5,13.5L4.08,12.08L12,4.16L19.92,12.08L18.5,13.5L13,8V20Z"}))},st=D((function(){return{root:{margin:4}}}))(R),ut=A((function(){return T({icons:{width:14,height:14}})})),dt="Sort ASC",mt="Sort DESC",vt="Hide Column",ft="Filter",pt=function(e){var t=e.index,n=e.sortable,l=e.columnKey,o=e.sorted,a=ut(),c=i(null),s=c[0],u=c[1],d=Boolean(s),m=be((function(e){return e.sortTable})),v=be((function(e){return e.filterAdd})),f=be((function(e){return e.toggleVisibleColumns})),p=function(){return m({index:t,sortType:"DESC",columnKey:l})},h=function(){return m({index:t,sortType:"ASC",columnKey:l})};return r.createElement(r.Fragment,null,n&&"DESC"===o&&r.createElement(st,{onClick:h},r.createElement(ct,{className:a.icons})),n&&"ASC"===o&&r.createElement(st,{onClick:p},r.createElement(at,{className:a.icons})),r.createElement(st,{onClick:function(e){u(e.currentTarget)}},r.createElement(Ne,{className:a.icons})),r.createElement(V,{disableScrollLock:!0,id:"long-menu",anchorEl:s,keepMounted:!0,open:d,onClose:function(){u(null)},PaperProps:{style:{}}},n&&r.createElement(H,{onClick:h},dt),n&&r.createElement(H,{onClick:p},mt),r.createElement(H,{onClick:function(){return f({index:t})}},vt),r.createElement(H,{onClick:function(){v({columnKey:l})}},ft)))},ht=function(e){var l=e.className,o=n(e,["className"]);return r.createElement(Le,t({className:l,id:"mdi-dots-vertical"},o),r.createElement("path",{d:"M11 24V5h2v24z"}))},gt=A((function(e){return T({columnContainer:{display:"flex",top:0,left:0,position:"sticky",zIndex:2,backgroundColor:"rgba(255,255,255,0.8)",alignItems:"center",borderBottom:"solid "+e.palette.grey[300]+" 1px"},titleText:{flex:1,fontFamily:"inherit"},dividerIcon:{pointerEvents:"none",display:"inline-block",width:24,height:24},dividerIconWrapper:{cursor:"col-resize",opacity:.4,"&:hover":{opacity:1}}})})),yt=function(e){var l=e.minWidth,o=void 0===l?100:l,i=e.label,a=e.colKey;e.CellComponent,e.HeaderComponent,e.visible;var c=e.sorted,s=e.sortable,u=e.resizable,d=e.colIndex,m=e.classes;e.sticky;var v=e.DividerProps,f=n(e,["minWidth","label","colKey","CellComponent","HeaderComponent","visible","sorted","sortable","resizable","colIndex","classes","sticky","DividerProps"]),p=gt(),h=rt(),g=ae().currentWidths,y=g[f["data-field"]]?g[f["data-field"]]:o;return r.createElement(r.Fragment,null,r.createElement("div",t({className:q(h.tableCell,"HESABA_TABLE_HEADER_CLASS",null==m?void 0:m.root),style:{minWidth:y||o,width:y||o}},f),r.createElement(r.Fragment,null,r.createElement(P,{align:"center",className:q(p.titleText,null==m?void 0:m.title)},i),r.createElement(pt,{index:d,sortable:s,columnKey:a,sorted:c}))),u&&r.createElement("div",{className:q("HESABA_DRAG_HANDLER",p.dividerIconWrapper)},r.createElement(ht,t({className:q(p.dividerIcon,null==m?void 0:m.divider)},v))))},Et=A((function(e){return T({headerContainer:{display:"flex",top:0,position:"sticky",zIndex:2,alignItems:"center"},commonHeaderContainer:{backgroundColor:"rgba(255,255,255,0.8)",borderBottom:"solid "+e.palette.grey[300]+" 1px"},titleText:{flex:1},dividerIcon:{pointerEvents:"none",width:24,height:24},dividerIconWrapper:{cursor:"col-resize",opacity:.4,"&:hover":{opacity:1}}})})),bt=function(e){var l=e.selectable,o=e.isSelected,i=e.classes,a=e.width,c=e.CheckboxProps,s=n(e,["selectable","isSelected","classes","width","CheckboxProps"]),u=Et(),d=rt(),v=Ce((function(e){return e.visibleColumns})),f=be((function(e){return e.toggleAllRows})),p=Ge(v,a);return r.createElement("div",{style:{height:ge,width:p()},className:q("HESABA_TABLE_ROW_CLASS",u.headerContainer,Ue(u.commonHeaderContainer,null==i?void 0:i.root))},l&&r.createElement(B,t({className:q("HESABA_TABLE_HEADER_CLASS"),checked:o,onChange:function(){f({isSelected:o})},color:"primary",classes:{root:d.checkbox}},c)),v.map((function(e,n){return r.createElement(m,{key:e.key},r.createElement(yt,t({},e,s,{colIndex:n,colKey:e.key,classes:null==i?void 0:i.cell})))})))},wt=A({root:{}}),Ct=v((function(e,n){return r.createElement("div",t({id:"MainVirtualListId"},e,{ref:n}))})),xt=d(v((function(e,l){var o,i=e.height,a=e.width,c=e.classes,s=e.onScroll,u=e.setTableRef,d=e.extraStyle,m=e.selectable,v=void 0!==m&&m,f=e.itemSize,p=void 0===f?function(){return ge}:f,h=e.resizable,g=e.sortable,y=e.VTCommonTableElProps,E=e.VTRowProps,b=e.VTFilterProps,w=e.VTHeaderProps,C=k().direction,x=Ce((function(e){return e.visibleRows})),S=Ce((function(e){return e.numRowsSelected})),R=wt();if(!x||0===x.length)return null;return r.createElement(J,{ref:l,direction:C,height:i,itemCount:x.length,onScroll:s,itemSize:p,itemKey:function(e){return""+e},width:a,itemData:x,outerRef:u,innerElementType:function(e){var l=e.children,o=e.style,i=n(e,["children","style"]);return r.createElement("div",t({},i,{style:t(t({},o),d)}),r.createElement(bt,t({selectable:v,isSelected:0!==S,classes:null==c?void 0:c.header,width:a,resizable:h,sortable:g},y,w,b)),l)},className:q(R.root,null===(o=null==c?void 0:c.table)||void 0===o?void 0:o.root),outerElementType:Ct},(function(e){var l=e.index,o=n(e,["index"]);return r.createElement(ot,t({rowIndex:l,selectable:v,classes:null==c?void 0:c.row,width:a},y,E,o))}))}))),St=function(e){var t=e.className;return r.createElement(Le,{className:t,id:"mdi-chevron-right"},r.createElement("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"}))},kt=function(e){var t=e.className;return r.createElement(Le,{className:t,id:"mdi-chevron-left"},r.createElement("path",{d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"}))},Rt=A((function(e){return T({paginationRoot:{display:"flex",width:"100%",border:0,flexWrap:"wrap",borderTop:"solid 1px "+e.palette.grey[300],alignItems:"center",justifyContent:"space-between"},actions:{flexShrink:0,marginLeft:20},toolbar:{minHeight:52,paddingRight:2},spacer:{flex:"1 1 100%"},caption:{flexShrink:0},selectRoot:{fontFamily:"inherit"},selectRootLTR:{marginRight:32,marginLeft:8},selectRootRTL:{marginRight:8,marginLeft:32},select:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"},selectIcon:{},input:{color:"inherit",fontSize:"inherit",flexShrink:0},menuItem:{},selectContainer:{display:"flex"}})}));function It(e){var t=e.page,n=e.onPageChange,l=e.count,o=e.rowsPerPage,i=I().t;return r.createElement("div",{style:{display:"flex",direction:"ltr"}},r.createElement(N,{title:null==i?void 0:i.prev,onClick:function(e){n(e,t-1)},disabled:0===t,color:"inherit"},r.createElement(kt,null)),r.createElement(N,{title:null==i?void 0:i.next,onClick:function(e){n(e,t+1)},disabled:-1!==l&&t>=Math.ceil(l/o)-1,color:"inherit"},r.createElement(St,null)))}function Lt(e){var l,o,i=e.classes,a=e.width,c=e.rowsPerPageOptions,s=void 0===c?[10,25,50,100]:c,u=e.page,d=e.count,m=e.rowsPerPage,v=e.onRowsPerPageChange,f=e.height,p=n(e,["classes","width","rowsPerPageOptions","page","count","rowsPerPage","onRowsPerPageChange","height"]),h=Rt(),g=I().t,y=k().direction,E=Ce((function(e){return e.numRowsSelected}));return r.createElement("div",{className:q(h.paginationRoot,null==i?void 0:i.root),style:{width:a,direction:y,height:f||70}},r.createElement(_,{className:h.toolbar},r.createElement("div",{className:h.spacer}),r.createElement(L,{color:"inherit",variant:"body2",className:h.caption},null==g?void 0:g.rowPerPage),r.createElement(M,{classes:{select:h.select,icon:h.selectIcon},input:r.createElement(K,{className:q(q(h.input,h.selectRoot,(l={},l[h.selectRootLTR]="ltr"===y,l),(o={},o[h.selectRootRTL]="ltr"!==y,o)))}),value:m,onChange:v},s.map((function(e){return r.createElement(H,{className:h.menuItem,key:e,value:e},e)}))),r.createElement(L,{color:"inherit",variant:"body2",className:h.caption},function(e){var t=e.from,n=e.to,r=e.count,l=I().t;return t+"-"+n+" "+(null==l?void 0:l.of)+" "+(-1!==r?r:""+(null==l?void 0:l.moreThan)+n)}({from:0===d?0:u*m+1,to:-1===d?(u+1)*m:-1===m?d:Math.min(d,(u+1)*m),count:-1===d?-1:d})),r.createElement(It,t({},p))),E>0&&r.createElement(L,null,E," ",g.rowSelected))}function Nt(e,t,n,r){if(!e&&!n)return r;var l=r;return n&&((null==n?void 0:n.height)?l-=null==n?void 0:n.height:l-=70),e&&(l-=t||70),l}var At=d((function(e){var l,o=e.rows,i=e.columns,s=e.width,d=void 0===s?"100%":s,m=e.height,v=e.hasFilter,f=void 0===v||v,p=e.hasToolbar,h=void 0===p||p,g=e.title,y=e.operationOnRows,E=e.classes,b=e.pagination,w=e.tableDataParser,C=e.VTContainerProps,x=e.VTToolbarProps,S=n(e,["rows","columns","width","height","hasFilter","hasToolbar","title","operationOnRows","classes","pagination","tableDataParser","VTContainerProps","VTToolbarProps"]);!function(e,t,n){var r=be((function(e){return e.setTableData}));u((function(){r(n?n(e,t):Re(e,t))}),[e,t,n])}(i,o,w);var k=ye().setTableRef,R=c(),I=c(),L=a((function(e){var t=e.scrollOffset;!e.scrollUpdateWasRequested&&R.current&&R.current.scrollTo(t)}),[]);return r.createElement(Je,t({classes:null==E?void 0:E.table},C,{width:d}),h&&r.createElement(Te,t({title:g,operationOnRows:y,classes:null==E?void 0:E.toolbar},x)),r.createElement("div",{role:"table",className:null===(l=null==E?void 0:E.table)||void 0===l?void 0:l.container,style:{display:"flex"}},r.createElement(Qe,null),r.createElement(xt,t({ref:I,width:d,onScroll:L,classes:E,setTableRef:k,height:Nt(h,null==x?void 0:x.height,b,m)},S)),r.createElement(Qe,null)),f&&r.createElement(Xe,null),b&&r.createElement(Lt,t({},b,{classes:null==E?void 0:E.footer,width:d})))})),Tt=function(e){var l=e.direction,o=e.language,i=e.theme,a=n(e,["direction","language","theme"]);return r.createElement(fe,null,r.createElement(pe,{direction:l,language:o,theme:i},r.createElement(At,t({},a))))},Pt=function(e){var t=e.className,n=e.width,l=e.height,o=e.children,i=e.onResize,a="number"==typeof n,c="number"==typeof l;return a&&c?r.createElement("div",{className:t,style:{width:n,height:l,position:"relative"}},o({width:n,height:l})):r.createElement(Q,{className:t,disableWidth:a,disableHeight:c,onResize:i},o)};export{Pt as AutoSizer,Tt as HesabaVirtualTable,he as MAIN_LIST_ID,pe as Provider,de as TableRowProvider,ie as TableSizeProvider,fe as TableStoreProvider,Te as TableToolbar,Pe as ToolbarMoreVert,We as ToolbarOperation,Je as VirtualTableContainer,Se as createEnhancedColumns,ke as createEnhancedRows,Re as parseTableData,xe as useStore,we as useStoreDispatch,be as useTStoreActions,Ce as useTStoreState,ve as useTableRowAction,me as useTableRowState,ce as useTableSizeAction,ae as useTableSizeState};
//# sourceMappingURL=index.esm.js.map
